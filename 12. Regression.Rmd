---
title: "13. Regression"
output: html_document
date: '2022-12-01'
---

REGRESSION

```{r}
install.packages("pacman")
pacman::p_load(pacman, dplyr, GGally, ggplot2, ggthemes, ggvis, httr, lubridate, plotly, rio, rmarkdown, shiny, stringr, tidyr)
```

```{r}
library(datasets)
```

```{r}
head(USJudgeRatings)
```

```{r}
data = USJudgeRatings
x = as.matrix(data[-12]) #retrieve all the data except the 12th column which is the dependent variable. This is to put all independent variable to a variable


y = data[,12]
```

*REGRESSION WITH SIMULTANEOUS ENTRY*
*Using all the x variable to predict the outcome*

```{r}
#OPTION 1: USING ALL THE VARIABLES
reg1 = lm(y~x)
```

```{r}
#OPTION 2: SPECIFYING THE VARIABLE INDIVIDUALLY
reg1 = lm (RTEN ~ CONT + INTG + DMNR + DILG + CFMG + DECI + PREP + FAMI + ORAL + WRIT + PHYS,
           data = USJudgeRatings)

```


*Results*
```{r}
reg1 #coefficients only
```

```{r}
summary(reg1) #inferential tests
```
*MORE SUMMARIES*


```{r}
anova(reg1) #coefficients w/inferential tests

```
```{r}
coef (reg1) #coefficients (same as reg1)

```


```{r}
confint(reg1) #CI for coefficients

```


```{r}
resid(reg1)  #Residuals case-by-case

```


```{r}
hist(residuals(reg1)) #histogram of residuals
```

*ADDITIONAL MODELS*
Other types of regression

```{r}
#Load 2 additonal libraries
p_load(lars,caret)
```

*CONVENTIONAL STEPWISE REGRESSION*
```{r}
stepwise = lars(x,y, type = "stepwise")
summary(stepwise)
```
*Stagewise: Like stepwise but with better generalizability*

```{r}
forward = lars(x,y, type = "forward.stagewise")
summary(forward)
```

*LAR: Least Angle Regression*
```{r}
lar = lars(x,y, type = "lar")
summary(lar)
```
*LASSO: Least Absolute Shrinkage and Selection Operator*

```{r}
lasso = lars(x, y , type = "lasso")
summary(lasso)
```
*Comparison of R square for new models*

```{r}
r2comp = c(stepwise$R2[6], forward$R2[6], lar$R2[6], lasso$R2[6]) %>% round(2)
names(r2comp) = c("Stepwise", "Forward", "Lar", "Lasso")
r2comp #shows the r square value
```


